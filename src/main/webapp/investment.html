<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FinMate - Ìà¨ÏûêÎ∂ÑÏÑù</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.3.4/vue.global.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.5.0/axios.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Malgun Gothic', 'Apple SD Gothic Neo', Arial, sans-serif;
            background: #f8f9fa;
            color: #333;
        }

        .header {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
        }

        .nav-menu {
            display: flex;
            gap: 30px;
        }

        .nav-item {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s;
            padding: 10px 15px;
            border-radius: 8px;
        }

        .nav-item:hover, .nav-item.active {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }

        .user-menu {
            position: relative;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            padding: 10px 15px;
            border-radius: 8px;
            transition: all 0.3s;
        }

        .user-info:hover {
            background: rgba(255,255,255,0.2);
        }

        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255,255,255,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        .page-header {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
        }

        .page-title {
            font-size: 2rem;
            margin-bottom: 10px;
            color: #333;
        }

        .page-subtitle {
            color: #666;
            font-size: 1.1rem;
        }

        .content-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .section-title {
            font-size: 1.3rem;
            margin-bottom: 20px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .risk-analysis {
            margin-bottom: 30px;
        }

        .risk-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 20px;
            border-left: 4px solid #667eea;
        }

        .risk-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .risk-type {
            font-size: 1.2rem;
            font-weight: bold;
            color: #333;
        }

        .risk-level {
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .risk-low {
            background: #d4edda;
            color: #155724;
        }

        .risk-medium {
            background: #fff3cd;
            color: #856404;
        }

        .risk-high {
            background: #f8d7da;
            color: #721c24;
        }

        .risk-description {
            color: #666;
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .recommendation-list {
            list-style: none;
            padding: 0;
        }

        .recommendation-list li {
            padding: 8px 0;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .recommendation-list li:last-child {
            border-bottom: none;
        }

        .recommendation-list li::before {
            content: 'üíé';
            font-size: 1rem;
        }

        .portfolio-section {
            margin-bottom: 30px;
        }

        .allocation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .allocation-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            border-left: 4px solid #28a745;
        }

        .allocation-title {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 10px;
            text-transform: uppercase;
            font-weight: 600;
        }

        .allocation-percentage {
            font-size: 2rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .allocation-amount {
            font-size: 0.9rem;
            color: #667eea;
            font-weight: 600;
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin-bottom: 20px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .stat-item {
            text-align: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.8rem;
            color: #666;
            text-transform: uppercase;
        }

        .quick-actions {
            display: grid;
            gap: 15px;
        }

        .action-btn {
            display: block;
            width: 100%;
            padding: 15px 20px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            text-decoration: none;
            border-radius: 10px;
            text-align: center;
            font-weight: 600;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
            font-size: 1rem;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .action-btn.secondary {
            background: #6c757d;
        }

        .action-btn.secondary:hover {
            background: #5a6268;
            box-shadow: 0 5px 15px rgba(108, 117, 125, 0.3);
        }

        .market-trends {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .trend-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #eee;
        }

        .trend-item:last-child {
            border-bottom: none;
        }

        .trend-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .trend-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #667eea;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .trend-details h4 {
            margin-bottom: 5px;
            color: #333;
        }

        .trend-details p {
            color: #666;
            font-size: 0.9rem;
        }

        .trend-change {
            text-align: right;
        }

        .change-value {
            font-weight: bold;
            font-size: 1.1rem;
        }

        .change-positive {
            color: #28a745;
        }

        .change-negative {
            color: #dc3545;
        }

        .change-period {
            font-size: 0.8rem;
            color: #666;
        }

        .alert {
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .alert-info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .alert-warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 50px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .tips-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-top: 30px;
        }

        .tip-item {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 4px solid #17a2b8;
        }

        .tip-item:last-child {
            margin-bottom: 0;
        }

        .tip-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tip-content {
            color: #666;
            line-height: 1.6;
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 20px;
            }

            .nav-menu {
                flex-wrap: wrap;
                justify-content: center;
            }

            .content-grid {
                grid-template-columns: 1fr;
            }

            .allocation-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }
        }
    </style>
</head>
<body>
<div id="app">
    <!-- Ìó§Îçî -->
    <header class="header">
        <div class="header-content">
            <div class="logo">üè¶ FinMate</div>
            <nav class="nav-menu">
                <a href="/" class="nav-item">Ìôà</a>
                <a href="/dashboard.html" class="nav-item">ÎåÄÏãúÎ≥¥Îìú</a>
                <a href="/financial.html" class="nav-item">Í∏àÏúµÍ¥ÄÎ¶¨</a>
                <a href="/investment.html" class="nav-item active">Ìà¨ÏûêÎ∂ÑÏÑù</a>
                <a href="/mypage.html" class="nav-item">ÎßàÏù¥ÌéòÏù¥ÏßÄ</a>
            </nav>
            <div class="user-menu" v-if="user">
                <div class="user-info" @click="goToPage('/mypage.html')">
                    <div class="avatar">{{ user.userName ? user.userName.charAt(0) : 'U' }}</div>
                    <span>{{ user.userName }}Îãò</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Î©îÏù∏ Ïª®ÌÖåÏù¥ÎÑà -->
    <div class="container">
        <!-- ÌéòÏù¥ÏßÄ Ìó§Îçî -->
        <div class="page-header">
            <h1 class="page-title">Ìà¨ÏûêÎ∂ÑÏÑù</h1>
            <p class="page-subtitle">Í∞úÏù∏ ÎßûÏ∂§Ìòï Ìà¨Ïûê Ï†ÑÎûµÍ≥º Ìè¨Ìä∏Ìè¥Î¶¨Ïò§Î•º Î∂ÑÏÑùÌïòÏÑ∏Ïöî</p>
        </div>

        <!-- Î°úÎî© ÏÉÅÌÉú -->
        <div v-if="isLoading" class="loading">
            <div class="spinner"></div>
        </div>

        <!-- Î©îÏù∏ Ïª®ÌÖêÏ∏† -->
        <div v-else>
            <!-- ÏïåÎ¶º Î©îÏãúÏßÄ -->
            <div v-if="alertMessage" :class="['alert', 'alert-' + alertType]">
                <span>{{ alertMessage }}</span>
            </div>

            <!-- Í∏àÏúµ ÌîÑÎ°úÌïÑ ÌïÑÏöî ÏïåÎ¶º -->
            <div v-if="!hasProfile" class="alert alert-warning">
                <span>‚ö†Ô∏è</span>
                <span>Ìà¨Ïûê Î∂ÑÏÑùÏùÑ ÏúÑÌï¥ Î®ºÏ†Ä Í∏àÏúµ ÌîÑÎ°úÌïÑÏùÑ ÏÑ§Ï†ïÌï¥Ï£ºÏÑ∏Ïöî.</span>
                <a href="/financial.html" style="margin-left: 15px;" class="btn btn-primary">ÌîÑÎ°úÌïÑ ÏÑ§Ï†ïÌïòÍ∏∞</a>
            </div>

            <!-- Ïª®ÌÖêÏ∏† Í∑∏Î¶¨Îìú -->
            <div v-else class="content-grid">
                <!-- Î©îÏù∏ Î∂ÑÏÑù ÏòÅÏó≠ -->
                <div>
                    <!-- Ìà¨Ïûê ÏÑ±Ìñ• Î∂ÑÏÑù -->
                    <div class="section risk-analysis">
                        <h2 class="section-title">
                            <span>üéØ</span>
                            Ìà¨Ïûê ÏÑ±Ìñ• Î∂ÑÏÑù
                        </h2>

                        <div v-if="riskAnalysis" class="risk-card">
                            <div class="risk-header">
                                <div class="risk-type">{{ getRiskProfileText(riskAnalysis.riskProfile) }}</div>
                                <span :class="['risk-level', getRiskLevelClass(riskAnalysis.riskProfile)]">
                                    {{ riskAnalysis.characteristics?.riskLevel || 'Î≥¥ÌÜµ' }}
                                </span>
                            </div>

                            <div class="risk-description">
                                {{ riskAnalysis.characteristics?.description }}
                            </div>

                            <div v-if="riskAnalysis.characteristics?.recommendedAssets">
                                <strong>Ï∂îÏ≤ú Ìà¨Ïûê ÏÉÅÌíà:</strong>
                                <ul class="recommendation-list">
                                    <li v-for="asset in riskAnalysis.characteristics.recommendedAssets" :key="asset">
                                        {{ asset }}
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Ìè¨Ìä∏Ìè¥Î¶¨Ïò§ Ï∂îÏ≤ú -->
                    <div class="section portfolio-section">
                        <h2 class="section-title">
                            <span>üìä</span>
                            Ï∂îÏ≤ú Ìè¨Ìä∏Ìè¥Î¶¨Ïò§
                        </h2>

                        <div v-if="portfolioRecommendation">
                            <!-- ÏûêÏÇ∞ Î∞∞Î∂Ñ -->
                            <div class="allocation-grid">
                                <div v-for="(percentage, asset) in portfolioRecommendation.portfolio" :key="asset" class="allocation-card">
                                    <div class="allocation-title">{{ asset }}</div>
                                    <div class="allocation-percentage">{{ percentage }}%</div>
                                    <div class="allocation-amount">
                                        {{ formatCurrency(calculateAllocationAmount(percentage)) }}
                                    </div>
                                </div>
                            </div>

                            <!-- Ï∞®Ìä∏ -->
                            <div class="chart-container">
                                <canvas id="portfolioChart"></canvas>
                            </div>

                            <!-- Ìà¨Ïûê ÌÜµÍ≥Ñ -->
                            <div class="stats-grid">
                                <div class="stat-item">
                                    <div class="stat-value">{{ formatCurrency(portfolioRecommendation.monthlyInvestment) }}</div>
                                    <div class="stat-label">Ïõî Í∂åÏû• Ìà¨ÏûêÏï°</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value">{{ riskAnalysis?.characteristics?.expectedReturn || 'N/A' }}</div>
                                    <div class="stat-label">ÏòàÏÉÅ ÏàòÏùµÎ•†</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value">{{ getRiskLevel() }}</div>
                                    <div class="stat-label">ÏúÑÌóò ÏàòÏ§Ä</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value">{{ getInvestmentPeriod() }}</div>
                                    <div class="stat-label">Ìà¨Ïûê Í∏∞Í∞Ñ</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ÏÇ¨Ïù¥ÎìúÎ∞î -->
                <div>
                    <!-- Îπ†Î•∏ Ïï°ÏÖò -->
                    <div class="section">
                        <h2 class="section-title">
                            <span>‚ö°</span>
                            Îπ†Î•∏ Ïï°ÏÖò
                        </h2>
                        <div class="quick-actions">
                            <button @click="refreshAnalysis" class="action-btn">
                                üîÑ Î∂ÑÏÑù ÏÉàÎ°úÍ≥†Ïπ®
                            </button>
                            <button @click="goToPage('/financial.html')" class="action-btn secondary">
                                ‚öôÔ∏è ÌîÑÎ°úÌïÑ ÏàòÏ†ï
                            </button>
                            <button @click="downloadReport" class="action-btn secondary">
                                üìÑ Î≥¥Í≥†ÏÑú Îã§Ïö¥Î°úÎìú
                            </button>
                            <button @click="goToPage('/dashboard.html')" class="action-btn secondary">
                                üìà ÎåÄÏãúÎ≥¥ÎìúÎ°ú
                            </button>
                        </div>
                    </div>

                    <!-- ÏãúÏû• ÎèôÌñ• -->
                    <div class="section">
                        <h2 class="section-title">
                            <span>üìà</span>
                            ÏãúÏû• ÎèôÌñ•
                        </h2>
                        <div class="trend-item">
                            <div class="trend-info">
                                <div class="trend-icon">üìä</div>
                                <div class="trend-details">
                                    <h4>ÏΩîÏä§Ìîº</h4>
                                    <p>ÌïúÍµ≠ Ï£ºÏãùÏãúÏû•</p>
                                </div>
                            </div>
                            <div class="trend-change">
                                <div class="change-value change-positive">+2.5%</div>
                                <div class="change-period">Ïò§Îäò</div>
                            </div>
                        </div>

                        <div class="trend-item">
                            <div class="trend-info">
                                <div class="trend-icon">üèõÔ∏è</div>
                                <div class="trend-details">
                                    <h4>Íµ≠Í≥†Ï±Ñ 3ÎÖÑ</h4>
                                    <p>ÏïàÏ†Ñ ÏûêÏÇ∞</p>
                                </div>
                            </div>
                            <div class="trend-change">
                                <div class="change-value change-negative">-0.1%</div>
                                <div class="change-period">Ïù¥Î≤à Ï£º</div>
                            </div>
                        </div>

                        <div class="trend-item">
                            <div class="trend-info">
                                <div class="trend-icon">üí±</div>
                                <div class="trend-details">
                                    <h4>Ïõê/Îã¨Îü¨</h4>
                                    <p>ÌôòÏú®</p>
                                </div>
                            </div>
                            <div class="trend-change">
                                <div class="change-value change-positive">+1.2%</div>
                                <div class="change-period">Ïù¥Î≤à Îã¨</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ìà¨Ïûê ÌåÅ ÏÑπÏÖò -->
            <div v-if="hasProfile" class="tips-section">
                <h2 class="section-title">
                    <span>üí°</span>
                    Ìà¨Ïûê ÌåÅ & Ï°∞Ïñ∏
                </h2>

                <div v-if="portfolioRecommendation?.goalBasedRecommendation">
                    <div class="tip-item">
                        <div class="tip-title">
                            <span>üéØ</span>
                            ÎßûÏ∂§Ìòï Ìà¨Ïûê Ï†ÑÎûµ
                        </div>
                        <div class="tip-content">
                            {{ portfolioRecommendation.goalBasedRecommendation.strategy }}
                        </div>
                    </div>

                    <div v-if="portfolioRecommendation.goalBasedRecommendation.tips" class="tip-item">
                        <div class="tip-title">
                            <span>‚ú®</span>
                            Ïã§Ïö©Ï†ÅÏù∏ Ìà¨Ïûê Ï°∞Ïñ∏
                        </div>
                        <div class="tip-content">
                            <ul>
                                <li v-for="tip in portfolioRecommendation.goalBasedRecommendation.tips" :key="tip">
                                    {{ tip }}
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="tip-item">
                    <div class="tip-title">
                        <span>üìö</span>
                        Í∏∞Î≥∏ Ìà¨Ïûê ÏõêÏπô
                    </div>
                    <div class="tip-content">
                        Î∂ÑÏÇ∞ Ìà¨ÏûêÎ•º ÌÜµÌï¥ ÏúÑÌóòÏùÑ Ï§ÑÏù¥Í≥†, Ïû•Í∏∞Ï†ÅÏù∏ Í¥ÄÏ†êÏóêÏÑú Íæ∏Ï§ÄÌûà Ìà¨ÏûêÌïòÏÑ∏Ïöî.
                        ÏãúÏû•Ïùò Îã®Í∏∞ Î≥ÄÎèôÏóê ÏùºÌù¨ÏùºÎπÑÌïòÏßÄ ÎßêÍ≥†, Î≥∏Ïù∏Ïùò Ìà¨Ïûê Î™©ÌëúÏôÄ ÏÑ±Ìñ•Ïóê ÎßûÎäî Ï†ÑÎûµÏùÑ Ïú†ÏßÄÌïòÎäî Í≤ÉÏù¥ Ï§ëÏöîÌï©ÎãàÎã§.
                    </div>
                </div>

                <div class="tip-item">
                    <div class="tip-title">
                        <span>‚ö†Ô∏è</span>
                        ÏúÑÌóò Í¥ÄÎ¶¨
                    </div>
                    <div class="tip-content">
                        Ìà¨Ïûê Í∏àÏï°ÏùÄ ÏÉùÌôúÎπÑÏôÄ ÎπÑÏÉÅÍ∏àÏùÑ Ï†úÏô∏Ìïú Ïó¨Ïú† ÏûêÍ∏àÏúºÎ°ú ÌïúÏ†ïÌïòÏÑ∏Ïöî.
                        Ìïú Î≤àÏóê ÌÅ∞ Í∏àÏï°ÏùÑ Ìà¨ÏûêÌïòÍ∏∞Î≥¥Îã§Îäî ÏãúÍ∞ÑÏùÑ Î∂ÑÏÇ∞ÌïòÏó¨ Ï†ïÍ∏∞Ï†ÅÏúºÎ°ú Ìà¨ÏûêÌïòÎäî Í≤ÉÏù¥ ÏïàÏ†ÑÌï©ÎãàÎã§.
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const { createApp, ref, reactive, onMounted, computed } = Vue;

    createApp({
        setup() {
            const isLoading = ref(true);
            const user = ref(null);
            const alertMessage = ref('');
            const alertType = ref('info');
            const hasProfile = ref(false);
            const riskAnalysis = ref(null);
            const portfolioRecommendation = ref(null);

            let portfolioChart = null;

            // API Í∏∞Î≥∏ ÏÑ§Ï†ï
            const API_BASE_URL = '/api';
            axios.defaults.baseURL = API_BASE_URL;

            // ÌÜ†ÌÅ∞ ÏÑ§Ï†ï
            const token = localStorage.getItem('accessToken');
            if (token) {
                axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;
            } else {
                window.location.href = '/member.html';
                return;
            }

            // ÏïåÎ¶º ÌëúÏãú
            const showAlert = (message, type = 'info', duration = 5000) => {
                alertMessage.value = message;
                alertType.value = type;
                setTimeout(() => {
                    alertMessage.value = '';
                }, duration);
            };

            // ÏÇ¨Ïö©Ïûê Ï†ïÎ≥¥ Î°úÎìú
            const loadUserInfo = async () => {
                try {
                    const response = await axios.get('/auth/me');
                    if (response.data.success) {
                        user.value = response.data.data;
                    }
                } catch (error) {
                    console.error('ÏÇ¨Ïö©Ïûê Ï†ïÎ≥¥ Î°úÎìú Ïã§Ìå®:', error);
                    localStorage.removeItem('accessToken');
                    window.location.href = '/member.html';
                }
            };

            // Í∏àÏúµ ÌîÑÎ°úÌïÑ ÌôïÏù∏
            const checkProfile = async () => {
                try {
                    const response = await axios.get('/financial/profile');
                    if (response.data.success) {
                        hasProfile.value = response.data.data.hasProfile;
                        if (!hasProfile.value) {
                            showAlert('Ìà¨Ïûê Î∂ÑÏÑùÏùÑ ÏúÑÌï¥ Î®ºÏ†Ä Í∏àÏúµ ÌîÑÎ°úÌïÑÏùÑ ÏÑ§Ï†ïÌï¥Ï£ºÏÑ∏Ïöî.', 'warning');
                        }
                    }
                } catch (error) {
                    hasProfile.value = false;
                    showAlert('Í∏àÏúµ ÌîÑÎ°úÌïÑ ÌôïÏù∏ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.', 'error');
                }
            };

            // Ìà¨Ïûê ÏÑ±Ìñ• Î∂ÑÏÑù Î°úÎìú
            const loadRiskAnalysis = async () => {
                try {
                    const response = await axios.get('/financial/risk-analysis');
                    if (response.data.success) {
                        riskAnalysis.value = response.data.data;
                    }
                } catch (error) {
                    showAlert('Ìà¨Ïûê ÏÑ±Ìñ• Î∂ÑÏÑù Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò§Îäî Îç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
                }
            };

            // Ìè¨Ìä∏Ìè¥Î¶¨Ïò§ Ï∂îÏ≤ú Î°úÎìú
            const loadPortfolioRecommendation = async () => {
                try {
                    const response = await axios.get('/financial/portfolio-recommendation');
                    if (response.data.success) {
                        portfolioRecommendation.value = response.data.data;
                    }
                } catch (error) {
                    showAlert('Ìè¨Ìä∏Ìè¥Î¶¨Ïò§ Ï∂îÏ≤ú Ï†ïÎ≥¥Î•º Î∂àÎü¨Ïò§Îäî Îç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
                }
            };

            // Ìè¨Ìä∏Ìè¥Î¶¨Ïò§ Ï∞®Ìä∏ ÏÉùÏÑ±
            const createPortfolioChart = () => {
                const ctx = document.getElementById('portfolioChart');
                if (!ctx || !portfolioRecommendation.value) return;

                const data = {
                    labels: Object.keys(portfolioRecommendation.value.portfolio),
                    datasets: [{
                        data: Object.values(portfolioRecommendation.value.portfolio),
                        backgroundColor: [
                            '#667eea',
                            '#764ba2',
                            '#f093fb',
                            '#f5576c',
                            '#4facfe',
                            '#00f2fe'
                        ],
                        borderWidth: 2,
                        borderColor: '#fff'
                    }]
                };

                portfolioChart = new Chart(ctx, {
                    type: 'doughnut',
                    data: data,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    padding: 20,
                                    usePointStyle: true
                                }
                            }
                        }
                    }
                });
            };

            // ÌÜµÌôî Ìè¨Îß∑
            const formatCurrency = (amount) => {
                if (amount == null) return '‚Ç©0';
                return new Intl.NumberFormat('ko-KR', {
                    style: 'currency',
                    currency: 'KRW',
                    minimumFractionDigits: 0
                }).format(amount);
            };

            // ÏúÑÌóò ÏÑ±Ìñ• ÌÖçÏä§Ìä∏
            const getRiskProfileText = (riskProfile) => {
                const texts = {
                    CONSERVATIVE: 'ÏïàÏ†ïÌòï Ìà¨ÏûêÏûê',
                    MODERATE: 'Ï§ëÎèÑÌòï Ìà¨ÏûêÏûê',
                    AGGRESSIVE: 'Í≥µÍ≤©Ìòï Ìà¨ÏûêÏûê'
                };
                return texts[riskProfile] || riskProfile;
            };

            // ÏúÑÌóò ÏàòÏ§Ä ÌÅ¥ÎûòÏä§
            const getRiskLevelClass = (riskProfile) => {
                const classes = {
                    CONSERVATIVE: 'risk-low',
                    MODERATE: 'risk-medium',
                    AGGRESSIVE: 'risk-high'
                };
                return classes[riskProfile] || 'risk-medium';
            };

            // ÏûêÏÇ∞ Î∞∞Î∂Ñ Í∏àÏï° Í≥ÑÏÇ∞
            const calculateAllocationAmount = (percentage) => {
                if (!portfolioRecommendation.value?.monthlyInvestment) return 0;
                return portfolioRecommendation.value.monthlyInvestment * (percentage / 100);
            };

            // ÏúÑÌóò ÏàòÏ§Ä ÌÖçÏä§Ìä∏
            const getRiskLevel = () => {
                return riskAnalysis.value?.characteristics?.riskLevel || 'Î≥¥ÌÜµ';
            };

            // Ìà¨Ïûê Í∏∞Í∞Ñ ÌÖçÏä§Ìä∏
            const getInvestmentPeriod = () => {
                return 'Ïû•Í∏∞ (5ÎÖÑ+)';
            };

            // Î∂ÑÏÑù ÏÉàÎ°úÍ≥†Ïπ®
            const refreshAnalysis = async () => {
                isLoading.value = true;
                showAlert('Î∂ÑÏÑùÏùÑ ÏÉàÎ°úÍ≥†Ïπ®ÌïòÍ≥† ÏûàÏäµÎãàÎã§...', 'info');

                try {
                    await Promise.all([
                        loadRiskAnalysis(),
                        loadPortfolioRecommendation()
                    ]);

                    // Ï∞®Ìä∏ Ïû¨ÏÉùÏÑ±
                    if (portfolioChart) {
                        portfolioChart.destroy();
                    }
                    setTimeout(createPortfolioChart, 100);

                    showAlert('Î∂ÑÏÑùÏù¥ ÏóÖÎç∞Ïù¥Ìä∏ÎêòÏóàÏäµÎãàÎã§.', 'success');
                } catch (error) {
                    showAlert('Î∂ÑÏÑù ÏÉàÎ°úÍ≥†Ïπ®Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
                } finally {
                    isLoading.value = false;
                }
            };

            // Î≥¥Í≥†ÏÑú Îã§Ïö¥Î°úÎìú
            const downloadReport = () => {
                showAlert('Î≥¥Í≥†ÏÑú Îã§Ïö¥Î°úÎìú Í∏∞Îä•ÏùÄ Ï§ÄÎπÑ Ï§ëÏûÖÎãàÎã§.', 'info');
            };

            // ÌéòÏù¥ÏßÄ Ïù¥Îèô
            const goToPage = (url) => {
                window.location.href = url;
            };

            // Ï¥àÍ∏∞Ìôî
            const initialize = async () => {
                isLoading.value = true;
                try {
                    await loadUserInfo();
                    await checkProfile();

                    if (hasProfile.value) {
                        await Promise.all([
                            loadRiskAnalysis(),
                            loadPortfolioRecommendation()
                        ]);

                        // Ï∞®Ìä∏Îäî DOMÏù¥ ÏóÖÎç∞Ïù¥Ìä∏Îêú ÌõÑ ÏÉùÏÑ±
                        setTimeout(createPortfolioChart, 100);
                    }
                } finally {
                    isLoading.value = false;
                }
            };

            onMounted(initialize);

            return {
                isLoading,
                user,
                alertMessage,
                alertType,
                hasProfile,
                riskAnalysis,
                portfolioRecommendation,
                showAlert,
                formatCurrency,
                getRiskProfileText,
                getRiskLevelClass,
                calculateAllocationAmount,
                getRiskLevel,
                getInvestmentPeriod,
                refreshAnalysis,
                downloadReport,
                goToPage
            };
        }
    }).mount('#app');
</script>
</script>
</script>
</body>
</html>