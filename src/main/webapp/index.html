<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FinMate</title>
    <style>
        body {
            font-family: 'Malgun Gothic', 'Apple SD Gothic Neo', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            max-width: 800px;
            margin: 0 auto;
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        h2 {
            color: #007bff;
            margin-top: 30px;
            margin-bottom: 15px;
        }
        .test-links {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .test-link {
            display: block;
            padding: 15px;
            background: #007bff;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            text-align: center;
            font-weight: bold;
            transition: all 0.3s;
        }
        .test-link:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,123,255,0.3);
        }
        .status {
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #28a745;
        }
        .status.error {
            border-left-color: #dc3545;
        }
        .console {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            margin: 20px 0;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>ğŸ¦ FinMate ì„œë²„</h1>
    <p style="text-align: center; color: #666; font-size: 18px;">ì„œë²„ê°€ ì •ìƒ ë™ì‘ ì¤‘ì…ë‹ˆë‹¤.</p>

    <div id="server-status" class="status">
        <strong>ì„œë²„ ìƒíƒœ:</strong> <span id="status-text">í™•ì¸ ì¤‘...</span>
    </div>

    <h2>ğŸ§ª í…ŒìŠ¤íŠ¸ ë§í¬</h2>
    <div class="test-links">
        <a href="/hello" class="test-link">ğŸ‘‹ Hello í…ŒìŠ¤íŠ¸</a>
        <a href="/ping" class="test-link">ğŸ“ Ping í…ŒìŠ¤íŠ¸</a>
        <a href="/api/member/health" class="test-link">â¤ï¸ Health ì²´í¬</a>
        <a href="/swagger-ui.html" class="test-link">ğŸ“– API ë¬¸ì„œ</a>
    </div>

    <h2>ğŸ“Š ì‹¤ì‹œê°„ í…ŒìŠ¤íŠ¸ ê²°ê³¼</h2>
    <div id="console" class="console">
        <div>FinMate ì„œë²„ í…ŒìŠ¤íŠ¸ ì‹œì‘...</div>
    </div>

    <h2>â„¹ï¸ ì„œë²„ ì •ë³´</h2>
    <div style="background: #e7f3ff; padding: 20px; border-radius: 8px; border-left: 4px solid #007bff;">
        <p><strong>í¬íŠ¸:</strong> 8080</p>
        <p><strong>ë°ì´í„°ë² ì´ìŠ¤:</strong> MySQL (localhost:3306/finmate_db)</p>
        <p><strong>ê´€ë¦¬ì ë„êµ¬:</strong> <a href="http://localhost:8081" target="_blank">phpMyAdmin</a></p>
        <p><strong>í˜„ì¬ ì‹œê°„:</strong> <span id="current-time"></span></p>
    </div>
</div>

<script>
    const console = document.getElementById('console');
    const statusDiv = document.getElementById('server-status');
    const statusText = document.getElementById('status-text');

    function log(message, type = 'info') {
        const timestamp = new Date().toLocaleTimeString();
        const color = type === 'error' ? '#ff6b6b' : type === 'success' ? '#51cf66' : '#74c0fc';
        console.innerHTML += `<div style="color: ${color};">[${timestamp}] ${message}</div>`;
        console.scrollTop = console.scrollHeight;
    }

    function updateStatus(message, isError = false) {
        statusText.textContent = message;
        statusDiv.className = isError ? 'status error' : 'status';
    }

    // í˜„ì¬ ì‹œê°„ ì—…ë°ì´íŠ¸
    function updateTime() {
        document.getElementById('current-time').textContent = new Date().toLocaleString('ko-KR');
    }
    updateTime();
    setInterval(updateTime, 1000);

    // ì„œë²„ ì—°ê²° í…ŒìŠ¤íŠ¸
    async function testEndpoint(url, name) {
        try {
            log(`${name} í…ŒìŠ¤íŠ¸ ì‹œì‘...`);
            const response = await fetch(url);

            if (response.ok) {
                const data = await response.json();
                log(`âœ… ${name} ì„±ê³µ: ${JSON.stringify(data)}`, 'success');
                return true;
            } else {
                log(`âŒ ${name} ì‹¤íŒ¨: ${response.status} ${response.statusText}`, 'error');
                return false;
            }
        } catch (error) {
            log(`âŒ ${name} ì˜¤ë¥˜: ${error.message}`, 'error');
            return false;
        }
    }

    // í…ìŠ¤íŠ¸ ì‘ë‹µ í…ŒìŠ¤íŠ¸
    async function testTextEndpoint(url, name) {
        try {
            log(`${name} í…ŒìŠ¤íŠ¸ ì‹œì‘...`);
            const response = await fetch(url);

            if (response.ok) {
                const text = await response.text();
                log(`âœ… ${name} ì„±ê³µ: ${text}`, 'success');
                return true;
            } else {
                log(`âŒ ${name} ì‹¤íŒ¨: ${response.status} ${response.statusText}`, 'error');
                return false;
            }
        } catch (error) {
            log(`âŒ ${name} ì˜¤ë¥˜: ${error.message}`, 'error');
            return false;
        }
    }

    // ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
    async function runAllTests() {
        log('=== ì„œë²„ í…ŒìŠ¤íŠ¸ ì‹œì‘ ===');

        const tests = [
            () => testEndpoint('/ping', 'Ping'),
            () => testTextEndpoint('/hello', 'Hello'),
            () => testEndpoint('/api/member/health', 'Health Check')
        ];

        let successCount = 0;

        for (const test of tests) {
            const success = await test();
            if (success) successCount++;
            await new Promise(resolve => setTimeout(resolve, 500)); // 0.5ì´ˆ ë”œë ˆì´
        }

        log(`=== í…ŒìŠ¤íŠ¸ ì™„ë£Œ: ${successCount}/${tests.length} ì„±ê³µ ===`);

        if (successCount === tests.length) {
            updateStatus('ğŸŸ¢ ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼');
        } else {
            updateStatus(`âš ï¸ ${tests.length - successCount}ê°œ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨`, true);
        }
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
    window.addEventListener('load', () => {
        setTimeout(runAllTests, 1000);
    });
</script>
</body>
</html>